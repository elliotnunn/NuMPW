# InteractiveHelp
#
# This script is a dialog-driven interface to the MPW Help command.
# It is used to implement the MPW Help menu item on the Balloon Help
# menu.
#
#	Usage:
#		InteractiveHelp
#
#	
#	© Copyright Apple Computer, Inc. 1994-1996, 1999
#	All rights reserved.

set exit 0
set Category "`GetListItem -s -m "Please select a category." ∂
               -d 'MPW Help Summary' 'Command Summary' ∂
			   'Editing Commands' 'File System Commands' 'Languages' ∂
			   'Projector Commands' 'PowerMacintosh Development' ∂
			   'MPW Scripting Summary' 'System Commands' ∂
			   'Miscellaneous Commands' 'Window Commands' ∂
			   'Resource Commands' 'Application Launching' ∂
			   'Expressions' 'Patterns' 'Selections' ∂
			   'Special Characters' 'MPW Shortcuts' 'Special Variables' ∂
			   'Help for a Specific Command…'; set temp "{status}"`"
exit 0 if "{temp}"

if {Category} == 'Help for a Specific Command…'
	set CommandList "`help commands | StreamEdit -e ' ∂
										/[ 	]*Help ≈#≈/ ∂
											Replace /[ 	]*Help ([¬ 	#]+)®1[ 	#]+≈/®1; ∂
											print; ∂
										1,$ Delete'`"
	set Category "`GetListItem -s -m 'Please select a command.' ∂
	               {CommandList}; set temp "{status}"`"
	exit 0 if "{temp}"
end

open -n "{TempFolder}Help Window"
saveonclose -n "{TempFolder}Help Window"

if {Category} == 'MPW Help Summary'
	help
else if {Category} == 'Command Summary'
	help Commands
else if {Category} == 'Editing Commands'
	help Editing
else if {Category} == 'File System Commands'
	help FileSystem
else if {Category} == 'Projector Commands'
	help Projector
else if {Category} == 'PowerMacintosh Development'
	help PowerMacintosh
else if {Category} == 'MPW Scripting Summary'
	help Scripting
else if {Category} == 'System Commands'
	help System
else if {Category} == 'Miscellaneous Commands'
	help Miscellaneous
else if {Category} == 'Window Commands'
	help Window
else if {Category} == 'Resource Commands'
	help Resources
else if {Category} == 'Application Launching'
	help Launch
else if {Category} == 'Special Characters'
	help Characters
else if {Category} == 'MPW Shortcuts'
	help Shortcuts
else if {Category} == 'Special Variables'
	help Variables
else
	help {Category}
end ∑ "{TempFolder}Help Window"


