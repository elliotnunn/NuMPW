    include 'Header.a'

    machine 68020

    StartOfTest 'bfextu ea{rand:1},dn'
    bsr     ResetTestMemory
    bfextu  (a4){25:1},d2
    n0
    z1
    v0
    c0
    cmp.l   #%0,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{rand:2},dn'
    bsr     ResetTestMemory
    bfextu  (a4){17:2},d2
    n0
    z1
    v0
    c0
    cmp.l   #%00,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{rand:32},dn'
    bsr     ResetTestMemory
    bfextu  (a4){15:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11000001010000011100001001000010,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #%11011110000010100111110001100000+1,d4 ; width
    bfextu  (a4){2:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #%0,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #%00111010000001111010001001100000+2,d4 ; width
    bfextu  (a4){30:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #%10101101011100011000101000000000+32,d4 ; width
    bfextu  (a4){17:d4},d2
    n0
    z0
    v0
    c0
    cmp.l   #%00000101000001110000100100001011,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{dn=rand:1},dn'
    bsr     ResetTestMemory
    move.l  #-$3c1,d3 ; offset
    bfextu  (a4){d3:1},d2
    n1
    z0
    v0
    c0
    cmp.l   #%1,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{dn=rand:2},dn'
    bsr     ResetTestMemory
    move.l  #-$144,d3 ; offset
    bfextu  (a4){d3:2},d2
    n0
    z0
    v0
    c0
    cmp.l   #%01,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{dn=rand:32},dn'
    bsr     ResetTestMemory
    move.l  #$1ef,d3 ; offset
    bfextu  (a4){d3:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11011111010111111110000001100000,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{dn=rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #-$149,d3 ; offset
    move.l  #%01010000110111011101110100000000+1,d4 ; width
    bfextu  (a4){d3:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #%0,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{dn=rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #-$3c7,d3 ; offset
    move.l  #%10101001010100110010101100100000+2,d4 ; width
    bfextu  (a4){d3:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #%00,d2
    z1
    EndOfTest

    StartOfTest 'bfextu ea{dn=rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #$1c6,d3 ; offset
    move.l  #%01011011001111111111001111100000+32,d4 ; width
    bfextu  (a4){d3:d4},d2
    n0
    z0
    v0
    c0
    cmp.l   #%00101110011011101010111011101111,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{rand:1},dn'
    bsr     ResetTestMemory
    bfextu  d7{17:1},d2
    n1
    z0
    v0
    c0
    cmp.l   #%1,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{rand:2},dn'
    bsr     ResetTestMemory
    bfextu  d7{14:2},d2
    n1
    z0
    v0
    c0
    cmp.l   #%10,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{rand:32},dn'
    bsr     ResetTestMemory
    bfextu  d7{3:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11010110110101111101100011011101,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #%11000011010001111110000110000000+1,d4 ; width
    bfextu  d7{17:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%1,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #%11000011010100011000010111100000+2,d4 ; width
    bfextu  d7{29:d4},d2
    n0
    z0
    v0
    c0
    cmp.l   #%01,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #%00000100101011100100100111000000+32,d4 ; width
    bfextu  d7{3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11010110110101111101100011011101,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{dn=rand:1},dn'
    bsr     ResetTestMemory
    move.l  #-$201,d3 ; offset
    bfextu  d7{d3:1},d2
    n1
    z0
    v0
    c0
    cmp.l   #%1,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{dn=rand:2},dn'
    bsr     ResetTestMemory
    move.l  #$32d,d3 ; offset
    bfextu  d7{d3:2},d2
    n0
    z0
    v0
    c0
    cmp.l   #%01,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{dn=rand:32},dn'
    bsr     ResetTestMemory
    move.l  #$196,d3 ; offset
    bfextu  d7{d3:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11000110111011101011011010111110,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{dn=rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #$2e7,d3 ; offset
    move.l  #%00101010010010111000100011000000+1,d4 ; width
    bfextu  d7{d3:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #%0,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{dn=rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #-$1fa,d3 ; offset
    move.l  #%11000101100110101111101001100000+2,d4 ; width
    bfextu  d7{d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%10,d2
    z1
    EndOfTest

    StartOfTest 'bfextu dn{dn=rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #-$fb,d3 ; offset
    move.l  #%11010100110000100011111100000000+32,d4 ; width
    bfextu  d7{d3:d4},d2
    n0
    z0
    v0
    c0
    cmp.l   #%01011011010111110110001101110111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{rand:1},dn'
    bsr     ResetTestMemory
    bfexts  (a4){15:1},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{rand:2},dn'
    bsr     ResetTestMemory
    bfexts  (a4){12:2},d2
    n0
    z1
    v0
    c0
    cmp.l   #%00000000000000000000000000000000,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{rand:32},dn'
    bsr     ResetTestMemory
    bfexts  (a4){3:32},d2
    n0
    z0
    v0
    c0
    cmp.l   #%00000100000011000001010000011100,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #%00101101010000010010111010000000+1,d4 ; width
    bfexts  (a4){8:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #%10011101001110011100001010000000+2,d4 ; width
    bfexts  (a4){22:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111110,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #%00010001100110111111011001100000+32,d4 ; width
    bfexts  (a4){4:d4},d2
    n0
    z0
    v0
    c0
    cmp.l   #%00001000000110000010100000111000,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{dn=rand:1},dn'
    bsr     ResetTestMemory
    move.l  #-$132,d3 ; offset
    bfexts  (a4){d3:1},d2
    n0
    z1
    v0
    c0
    cmp.l   #%00000000000000000000000000000000,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{dn=rand:2},dn'
    bsr     ResetTestMemory
    move.l  #$ad,d3 ; offset
    bfexts  (a4){d3:2},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111110,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{dn=rand:32},dn'
    bsr     ResetTestMemory
    move.l  #$136,d3 ; offset
    bfexts  (a4){d3:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #%10101001111010100010101001101010,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{dn=rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #$398,d3 ; offset
    move.l  #%00000000110101011110011100100000+1,d4 ; width
    bfexts  (a4){d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{dn=rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #$104,d3 ; offset
    move.l  #%00000111001110001001011001100000+2,d4 ; width
    bfexts  (a4){d3:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #%00000000000000000000000000000000,d2
    z1
    EndOfTest

    StartOfTest 'bfexts ea{dn=rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #-$2ca,d3 ; offset
    move.l  #%10101111000010110101010011000000+32,d4 ; width
    bfexts  (a4){d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%10001001110010100000101001001010,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{rand:1},dn'
    bsr     ResetTestMemory
    bfexts  d7{22:1},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{rand:2},dn'
    bsr     ResetTestMemory
    bfexts  d7{12:2},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111110,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{rand:32},dn'
    bsr     ResetTestMemory
    bfexts  d7{20:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #%10110001101110111010110110101111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #%10111101001011111101100001000000+1,d4 ; width
    bfexts  d7{26:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #%00000000000000000000000000000000,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #%00110011111010000100111101000000+2,d4 ; width
    bfexts  d7{8:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #%01101011011111000001000000100000+32,d4 ; width
    bfexts  d7{17:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11110110001101110111010110110101,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{dn=rand:1},dn'
    bsr     ResetTestMemory
    move.l  #$90,d3 ; offset
    bfexts  d7{d3:1},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{dn=rand:2},dn'
    bsr     ResetTestMemory
    move.l  #-$7d,d3 ; offset
    bfexts  d7{d3:2},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{dn=rand:32},dn'
    bsr     ResetTestMemory
    move.l  #$45,d3 ; offset
    bfexts  d7{d3:32},d2
    n0
    z0
    v0
    c0
    cmp.l   #%01011011010111110110001101110111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{dn=rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #-$1fe,d3 ; offset
    move.l  #%00100000111010111111011100000000+1,d4 ; width
    bfexts  d7{d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{dn=rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #$39b,d3 ; offset
    move.l  #%00000100001011111111100110100000+2,d4 ; width
    bfexts  d7{d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d2
    z1
    EndOfTest

    StartOfTest 'bfexts dn{dn=rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #$3c6,d3 ; offset
    move.l  #%11000101010101011011100101000000+32,d4 ; width
    bfexts  d7{d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #%10110110101111101100011011101110,d2
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{rand:1}'
    bsr     ResetTestMemory
    move.l  #%00010010001000100101111010001111,d2
    bfins   d2,(a4){6:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10000010100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{rand:2}'
    bsr     ResetTestMemory
    move.l  #%11010001101101111101000011101000,d2
    bfins   d2,(a4){8:2}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000000000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{rand:32}'
    bsr     ResetTestMemory
    move.l  #%11000001111100110010111001100111,d2
    bfins   d2,(a4){20:32}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000100000011000110000011111,$0(a4)
    z1
    cmp.l   #%00110010111001100111011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%01010010111010000100110010001111,d2
    move.l  #%00100110000100011110011101100000+1,d4 ; width
    bfins   d2,(a4){23:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000100000011000001110000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%10100110110000110101100011100101,d2
    move.l  #%11011110111000000001001101100000+2,d4 ; width
    bfins   d2,(a4){12:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10000000100001011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%10001101000100010110100001101101,d2
    move.l  #%10101011101111100010100101100000+32,d4 ; width
    bfins   d2,(a4){23:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000100000011000001100011010,$0(a4)
    z1
    cmp.l   #%00100010110100001101101010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #%00000000101001111100001001111110,d2
    move.l  #$8a,d3 ; offset
    bfins   d2,(a4){d3:1}
    n0
    z1
    v0
    c0
    cmp.l   #%10010000100100011001001010010011,$10(a4)
    z1
    cmp.l   #%10010100100101011001011010010111,$14(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #%01110001010001001110101010111111,d2
    move.l  #-$17c,d3 ; offset
    bfins   d2,(a4){d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%01011100010100010101001001010011,-$30(a4)
    z1
    cmp.l   #%01010100010101010101011001010111,-$2c(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #%01000111000100101000010011000100,d2
    move.l  #$2ee,d3 ; offset
    bfins   d2,(a4){d3:32}
    n0
    z0
    v0
    c0
    cmp.l   #%11011100110111010001110001001010,$5c(a4)
    z1
    cmp.l   #%00010011000100011110001011100011,$60(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%10110100100110100000000110110111,d2
    move.l  #$2d9,d3 ; offset
    move.l  #%01110111001000110111011100100000+1,d4 ; width
    bfins   d2,(a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%11011000110110011101101011011011,$58(a4)
    z1
    cmp.l   #%11011100110111011101111011011111,$5c(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%10011111110110101101011010010110,d2
    move.l  #$289,d3 ; offset
    move.l  #%00101101010001100010110100000000+2,d4 ; width
    bfins   d2,(a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%11010000110100011101001011010011,$50(a4)
    z1
    cmp.l   #%11010100110101011101011011010111,$54(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,ea{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%10000000101011001110010010101100,d2
    move.l  #$1ac,d3 ; offset
    move.l  #%00101100111001000000101011000000+32,d4 ; width
    bfins   d2,(a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10110100101110000000101011001110,$34(a4)
    z1
    cmp.l   #%01001010110010011011101010111011,$38(a4)
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{rand:1}'
    bsr     ResetTestMemory
    move.l  #%10101011100110010101010010000111,d2
    bfins   d2,d7{12:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{rand:2}'
    bsr     ResetTestMemory
    move.l  #%01111011011000011010110000110100,d2
    bfins   d2,d7{24:2}
    n0
    z1
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{rand:32}'
    bsr     ResetTestMemory
    move.l  #%00110101111100100001010101010111,d2
    bfins   d2,d7{10:32}
    n0
    z0
    v0
    c0
    cmp.l   #%01010101110011010111110010000101,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%10111000111100111011101100001101,d2
    move.l  #%10110011101110111111011101100000+1,d4 ; width
    bfins   d2,d7{22:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%11011010010010011110010001101101,d2
    move.l  #%00010100101001011011011010100000+2,d4 ; width
    bfins   d2,d7{5:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%11011111100010010011010001100111,d2
    move.l  #%01001110000001101111100100100000+32,d4 ; width
    bfins   d2,d7{24:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10001001001101000110011111011111,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #%00110110110111111110001010011111,d2
    move.l  #$109,d3 ; offset
    bfins   d2,d7{d3:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #%01010010011000100000111111111111,d2
    move.l  #-$367,d3 ; offset
    bfins   d2,d7{d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101101111011,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #%00010011001101111000011110011000,d2
    move.l  #-$a2,d3 ; offset
    bfins   d2,d7{d3:32}
    n0
    z0
    v0
    c0
    cmp.l   #%01001100110111100001111001100000,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%01101111111110000110000101100001,d2
    move.l  #$38,d3 ; offset
    move.l  #%10110111110111011000001000000000+1,d4 ; width
    bfins   d2,d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101110011011,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%10101111100101100101010111000101,d2
    move.l  #$21d,d3 ; offset
    move.l  #%01001011101001010110101100100000+2,d4 ; width
    bfins   d2,d7{d3:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfins dn=rand,dn{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%10101010101001101011110000111101,d2
    move.l  #$78,d3 ; offset
    move.l  #%01000011011000110111010110100000+32,d4 ; width
    bfins   d2,d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10100110101111000011110110101010,d7
    z1
    EndOfTest

    StartOfTest 'bftst ea{rand:1}'
    bsr     ResetTestMemory
    bftst   (a4){22:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{rand:2}'
    bsr     ResetTestMemory
    bftst   (a4){10:2}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{rand:32}'
    bsr     ResetTestMemory
    bftst   (a4){8:32}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%01001100101010011001101100100000+1,d4 ; width
    bftst   (a4){22:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%00001101111010000000110001100000+2,d4 ; width
    bftst   (a4){25:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%10100100110011010010101011000000+32,d4 ; width
    bftst   (a4){12:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #$2ce,d3 ; offset
    bftst   (a4){d3:1}
    n0
    z1
    v0
    c0
    cmp.l   #%11011000110110011101101011011011,$58(a4)
    z1
    cmp.l   #%11011100110111011101111011011111,$5c(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #-$57,d3 ; offset
    bftst   (a4){d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%01110100011101010111011001110111,-$c(a4)
    z1
    cmp.l   #%01111000011110010111101001111011,-$8(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #$2b2,d3 ; offset
    bftst   (a4){d3:32}
    n0
    z0
    v0
    c0
    cmp.l   #%11010100110101011101011011010111,$54(a4)
    z1
    cmp.l   #%11011000110110011101101011011011,$58(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #-$195,d3 ; offset
    move.l  #%11100110101011000101001111100000+1,d4 ; width
    bftst   (a4){d3:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%01001100010011010100111001001111,-$34(a4)
    z1
    cmp.l   #%01010000010100010101001001010011,-$30(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #-$41,d3 ; offset
    move.l  #%00111100100101101001111000100000+2,d4 ; width
    bftst   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%01110100011101010111011001110111,-$c(a4)
    z1
    cmp.l   #%01111000011110010111101001111011,-$8(a4)
    z1
    EndOfTest

    StartOfTest 'bftst ea{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #$3d4,d3 ; offset
    move.l  #%11000111100100001000001100000000+32,d4 ; width
    bftst   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%11111000111110011111101011111011,$78(a4)
    z1
    cmp.l   #%11111100111111011111111011111111,$7c(a4)
    z1
    EndOfTest

    StartOfTest 'bftst dn{rand:1}'
    bsr     ResetTestMemory
    bftst   d7{27:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{rand:2}'
    bsr     ResetTestMemory
    bftst   d7{10:2}
    n0
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{rand:32}'
    bsr     ResetTestMemory
    bftst   d7{9:32}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%11010110111010001011100101100000+1,d4 ; width
    bftst   d7{18:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%00111010111101111000001111000000+2,d4 ; width
    bftst   d7{19:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%11100001011100010011010111100000+32,d4 ; width
    bftst   d7{3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #$22a,d3 ; offset
    bftst   d7{d3:1}
    n0
    z1
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #$26e,d3 ; offset
    bftst   d7{d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #$1f6,d3 ; offset
    bftst   d7{d3:32}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #$58,d3 ; offset
    move.l  #%11000110100111111000110110100000+1,d4 ; width
    bftst   d7{d3:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #$6,d3 ; offset
    move.l  #%00100011100101101000101011100000+2,d4 ; width
    bftst   d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bftst dn{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #$48,d3 ; offset
    move.l  #%11100101000001001010100001100000+32,d4 ; width
    bftst   d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg ea{rand:1}'
    bsr     ResetTestMemory
    bfchg   (a4){6:1}
    n0
    z1
    v0
    c0
    cmp.l   #%10000010100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{rand:2}'
    bsr     ResetTestMemory
    bfchg   (a4){14:2}
    n0
    z0
    v0
    c0
    cmp.l   #%10000000100000101000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{rand:32}'
    bsr     ResetTestMemory
    bfchg   (a4){14:32}
    n0
    z0
    v0
    c0
    cmp.l   #%10000000100000100111110101111100,$0(a4)
    z1
    cmp.l   #%01111011011110011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%01011111100100110000101100100000+1,d4 ; width
    bfchg   (a4){8:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000000000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%11000100001010010010100100000000+2,d4 ; width
    bfchg   (a4){27:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011000001010011011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%10010110000110011100001010100000+32,d4 ; width
    bfchg   (a4){18:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10000000100000011011110101111100,$0(a4)
    z1
    cmp.l   #%01111011011110100100011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #$18f,d3 ; offset
    bfchg   (a4){d3:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10110000101100001011001010110011,$30(a4)
    z1
    cmp.l   #%10110100101101011011011010110111,$34(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #-$215,d3 ; offset
    bfchg   (a4){d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%00111100001001010011111000111111,-$44(a4)
    z1
    cmp.l   #%01000000010000010100001001000011,-$40(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #$38f,d3 ; offset
    bfchg   (a4){d3:32}
    n1
    z0
    v0
    c0
    cmp.l   #%11110000111100000000110100001100,$70(a4)
    z1
    cmp.l   #%00001011000010111111011011110111,$74(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #$2e0,d3 ; offset
    move.l  #%11001010100010100100011011000000+1,d4 ; width
    bfchg   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%01011100110111011101111011011111,$5c(a4)
    z1
    cmp.l   #%11100000111000011110001011100011,$60(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #$21f,d3 ; offset
    move.l  #%10101001100111111010101111100000+2,d4 ; width
    bfchg   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%11000000110000011100001011000010,$40(a4)
    z1
    cmp.l   #%01000100110001011100011011000111,$44(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg ea{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #-$fd,d3 ; offset
    move.l  #%01111111101100001110110101100000+32,d4 ; width
    bfchg   (a4){d3:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%01111111100111101001110110011100,-$20(a4)
    z1
    cmp.l   #%10000100011001010110011001100111,-$1c(a4)
    z1
    EndOfTest

    StartOfTest 'bfchg dn{rand:1}'
    bsr     ResetTestMemory
    bfchg   d7{21:1}
    n0
    z1
    v0
    c0
    cmp.l   #%10111010110110101111111100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{rand:2}'
    bsr     ResetTestMemory
    bfchg   d7{21:2}
    n0
    z0
    v0
    c0
    cmp.l   #%10111010110110101111110100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{rand:32}'
    bsr     ResetTestMemory
    bfchg   d7{7:32}
    n0
    z0
    v0
    c0
    cmp.l   #%01000101001001010000010011100100,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%01110111011010111100001001000000+1,d4 ; width
    bfchg   d7{21:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10111010110110101111111100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%11010100100000000001010000100000+2,d4 ; width
    bfchg   d7{19:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101110001100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%10010010111100110011011000000000+32,d4 ; width
    bfchg   d7{3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%01000101001001010000010011100100,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #$59,d3 ; offset
    bfchg   d7{d3:1}
    n0
    z1
    v0
    c0
    cmp.l   #%10111010110110101111101101011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #$2a6,d3 ; offset
    bfchg   d7{d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%10111001110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #-$239,d3 ; offset
    bfchg   d7{d3:32}
    n0
    z0
    v0
    c0
    cmp.l   #%01000101001001010000010011100100,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #-$235,d3 ; offset
    move.l  #%01010011100010011010001101000000+1,d4 ; width
    bfchg   d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110010101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #$223,d3 ; offset
    move.l  #%00011000101000001011010001000000+2,d4 ; width
    bfchg   d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10100010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfchg dn{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #-$f2,d3 ; offset
    move.l  #%01111001010101101011011101000000+32,d4 ; width
    bfchg   d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%01000101001001010000010011100100,d7
    z1
    EndOfTest

    StartOfTest 'bfclr ea{rand:1}'
    bsr     ResetTestMemory
    bfclr   (a4){5:1}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{rand:2}'
    bsr     ResetTestMemory
    bfclr   (a4){19:2}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{rand:32}'
    bsr     ResetTestMemory
    bfclr   (a4){18:32}
    n0
    z0
    v0
    c0
    cmp.l   #%10000000100000011000000000000000,$0(a4)
    z1
    cmp.l   #%00000000000000000000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%10101011111100100011001111000000+1,d4 ; width
    bfclr   (a4){20:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%00000011111010010000100011100000+2,d4 ; width
    bfclr   (a4){19:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%10011111101110011011001010100000+32,d4 ; width
    bfclr   (a4){13:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10000000100000000000000000000000,$0(a4)
    z1
    cmp.l   #%00000000000001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #$1ef,d3 ; offset
    bfclr   (a4){d3:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10111100101111001011111010111111,$3c(a4)
    z1
    cmp.l   #%11000000110000011100001011000011,$40(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #$2ac,d3 ; offset
    bfclr   (a4){d3:2}
    n0
    z0
    v0
    c0
    cmp.l   #%11010100110100011101011011010111,$54(a4)
    z1
    cmp.l   #%11011000110110011101101011011011,$58(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #$3db,d3 ; offset
    bfclr   (a4){d3:32}
    n1
    z0
    v0
    c0
    cmp.l   #%11111000111110011111101011100000,$78(a4)
    z1
    cmp.l   #%00000000000000000000000000011111,$7c(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #-$215,d3 ; offset
    move.l  #%01011111110100111100011011000000+1,d4 ; width
    bfclr   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%00111100001011010011111000111111,-$44(a4)
    z1
    cmp.l   #%01000000010000010100001001000011,-$40(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #-$21e,d3 ; offset
    move.l  #%11110000001100000001011000100000+2,d4 ; width
    bfclr   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%00001100001111010011111000111111,-$44(a4)
    z1
    cmp.l   #%01000000010000010100001001000011,-$40(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr ea{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #$3d0,d3 ; offset
    move.l  #%10000101111000000111000011100000+32,d4 ; width
    bfclr   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%11111000111110010000000000000000,$78(a4)
    z1
    cmp.l   #%00000000000000001111111011111111,$7c(a4)
    z1
    EndOfTest

    StartOfTest 'bfclr dn{rand:1}'
    bsr     ResetTestMemory
    bfclr   d7{31:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011010,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{rand:2}'
    bsr     ResetTestMemory
    bfclr   d7{22:2}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111100000011011,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{rand:32}'
    bsr     ResetTestMemory
    bfclr   d7{13:32}
    n0
    z0
    v0
    c0
    cmp.l   #%00000000000000000000000000000000,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%11011101000010110101110100000000+1,d4 ; width
    bfclr   d7{25:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%10011001100110101101011101100000+2,d4 ; width
    bfclr   d7{14:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110001111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%01111110001110000011000111100000+32,d4 ; width
    bfclr   d7{18:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%00000000000000000000000000000000,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #-$310,d3 ; offset
    bfclr   d7{d3:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110100111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #$153,d3 ; offset
    bfclr   d7{d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101110001100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #-$78,d3 ; offset
    bfclr   d7{d3:32}
    n1
    z0
    v0
    c0
    cmp.l   #%00000000000000000000000000000000,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #$1ac,d3 ; offset
    move.l  #%10011001111011110111011001000000+1,d4 ; width
    bfclr   d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110100101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #-$283,d3 ; offset
    move.l  #%11011010000110100100010100100000+2,d4 ; width
    bfclr   d7{d3:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011001,d7
    z1
    EndOfTest

    StartOfTest 'bfclr dn{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #-$31e,d3 ; offset
    move.l  #%00010100110000010101011111000000+32,d4 ; width
    bfclr   d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%00000000000000000000000000000000,d7
    z1
    EndOfTest

    StartOfTest 'bfset ea{rand:1}'
    bsr     ResetTestMemory
    bfset   (a4){4:1}
    n0
    z1
    v0
    c0
    cmp.l   #%10001000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{rand:2}'
    bsr     ResetTestMemory
    bfset   (a4){5:2}
    n0
    z1
    v0
    c0
    cmp.l   #%10000110100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{rand:32}'
    bsr     ResetTestMemory
    bfset   (a4){8:32}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000111111111111111111111111,$0(a4)
    z1
    cmp.l   #%11111111100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%00110111100010011010111001100000+1,d4 ; width
    bfset   (a4){18:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011010001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%01011100111010001111101101100000+2,d4 ; width
    bfset   (a4){26:d4}
    n0
    z1
    v0
    c0
    cmp.l   #%10000000100000011000001010110011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%00011011001001110001001111000000+32,d4 ; width
    bfset   (a4){12:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10000000100011111111111111111111,$0(a4)
    z1
    cmp.l   #%11111111111101011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #$16,d3 ; offset
    bfset   (a4){d3:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10000000100000011000001010000011,$0(a4)
    z1
    cmp.l   #%10000100100001011000011010000111,$4(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #-$26d,d3 ; offset
    bfset   (a4){d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%00110000001100010011101000110011,-$50(a4)
    z1
    cmp.l   #%00110100001101010011011000110111,-$4c(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #$18f,d3 ; offset
    bfset   (a4){d3:32}
    n1
    z0
    v0
    c0
    cmp.l   #%10110000101100011111111111111111,$30(a4)
    z1
    cmp.l   #%11111111111111111011011010110111,$34(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #$2c3,d3 ; offset
    move.l  #%11110100110001100001011110000000+1,d4 ; width
    bfset   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%11011000110110011101101011011011,$58(a4)
    z1
    cmp.l   #%11011100110111011101111011011111,$5c(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #$112,d3 ; offset
    move.l  #%00100110001001110010010011000000+2,d4 ; width
    bfset   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10100000101000011011001010100011,$20(a4)
    z1
    cmp.l   #%10100100101001011010011010100111,$24(a4)
    z1
    EndOfTest

    StartOfTest 'bfset ea{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #$2fc,d3 ; offset
    move.l  #%01111011001111010010101100000000+32,d4 ; width
    bfset   (a4){d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%11011100110111011101111011011111,$5c(a4)
    z1
    cmp.l   #%11111111111111111111111111110011,$60(a4)
    z1
    EndOfTest

    StartOfTest 'bfset dn{rand:1}'
    bsr     ResetTestMemory
    bfset   d7{14:1}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{rand:2}'
    bsr     ResetTestMemory
    bfset   d7{0:2}
    n1
    z0
    v0
    c0
    cmp.l   #%11111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{rand:32}'
    bsr     ResetTestMemory
    bfset   d7{1:32}
    n0
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #%11110000010100111000111000100000+1,d4 ; width
    bfset   d7{20:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #%01010001110111111000000111100000+2,d4 ; width
    bfset   d7{29:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011111,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #%01010101111110001000101101000000+32,d4 ; width
    bfset   d7{4:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{dn=rand:1}'
    bsr     ResetTestMemory
    move.l  #-$47,d3 ; offset
    bfset   d7{d3:1}
    n0
    z1
    v0
    c0
    cmp.l   #%10111010110110101111101101011011,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{dn=rand:2}'
    bsr     ResetTestMemory
    move.l  #-$218,d3 ; offset
    bfset   d7{d3:2}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{dn=rand:32}'
    bsr     ResetTestMemory
    move.l  #$2e8,d3 ; offset
    bfset   d7{d3:32}
    n1
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{dn=rand:dn=rand+1}'
    bsr     ResetTestMemory
    move.l  #-$170,d3 ; offset
    move.l  #%11111011110000001110111010100000+1,d4 ; width
    bfset   d7{d3:d4}
    n1
    z0
    v0
    c0
    cmp.l   #%10111010110110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{dn=rand:dn=rand+2}'
    bsr     ResetTestMemory
    move.l  #-$176,d3 ; offset
    move.l  #%00110001100010111011011110000000+2,d4 ; width
    bfset   d7{d3:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%10111010111110101111101100011011,d7
    z1
    EndOfTest

    StartOfTest 'bfset dn{dn=rand:dn=rand+32}'
    bsr     ResetTestMemory
    move.l  #$4d,d3 ; offset
    move.l  #%10110001111011111010000110100000+32,d4 ; width
    bfset   d7{d3:d4}
    n0
    z0
    v0
    c0
    cmp.l   #%11111111111111111111111111111111,d7
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{rand:1},dn'
    bsr     ResetTestMemory
    bfffo  (a4){29:1},d2
    n0
    z1
    v0
    c0
    cmp.l   #$1e,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{rand:2},dn'
    bsr     ResetTestMemory
    bfffo  (a4){4:2},d2
    n0
    z1
    v0
    c0
    cmp.l   #$6,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{rand:32},dn'
    bsr     ResetTestMemory
    bfffo  (a4){15:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #$f,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #%01010001101011000100011100100000+1,d4 ; width
    bfffo  (a4){15:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #$f,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #%01111111010100111101000111100000+2,d4 ; width
    bfffo  (a4){18:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #$14,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #%10010001011110110100101010000000+32,d4 ; width
    bfffo  (a4){14:d4},d2
    n0
    z0
    v0
    c0
    cmp.l   #$f,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{dn=rand:1},dn'
    bsr     ResetTestMemory
    move.l  #$12,d3 ; offset
    bfffo  (a4){d3:1},d2
    n0
    z1
    v0
    c0
    cmp.l   #$13,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{dn=rand:2},dn'
    bsr     ResetTestMemory
    move.l  #$1c2,d3 ; offset
    bfffo  (a4){d3:2},d2
    n1
    z0
    v0
    c0
    cmp.l   #$1c2,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{dn=rand:32},dn'
    bsr     ResetTestMemory
    move.l  #-$1b4,d3 ; offset
    bfffo  (a4){d3:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #-$1b4,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{dn=rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #-$121,d3 ; offset
    move.l  #%00110101101001001000000100000000+1,d4 ; width
    bfffo  (a4){d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #-$121,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{dn=rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #-$333,d3 ; offset
    move.l  #%01110011011010101110100110100000+2,d4 ; width
    bfffo  (a4){d3:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #-$331,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  ea{dn=rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #$2b7,d3 ; offset
    move.l  #%11111010110010011111101101100000+32,d4 ; width
    bfffo  (a4){d3:d4},d2
    n0
    z0
    v0
    c0
    cmp.l   #$2b8,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{rand:1},dn'
    bsr     ResetTestMemory
    bfffo  d7{26:1},d2
    n0
    z1
    v0
    c0
    cmp.l   #$1b,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{rand:2},dn'
    bsr     ResetTestMemory
    bfffo  d7{15:2},d2
    n0
    z0
    v0
    c0
    cmp.l   #$10,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{rand:32},dn'
    bsr     ResetTestMemory
    bfffo  d7{24:32},d2
    n0
    z0
    v0
    c0
    cmp.l   #$1b,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #%10100100011100111000111110000000+1,d4 ; width
    bfffo  d7{5:d4},d2
    n0
    z1
    v0
    c0
    cmp.l   #$6,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #%00001000011110100001001111000000+2,d4 ; width
    bfffo  d7{10:d4},d2
    n0
    z0
    v0
    c0
    cmp.l   #$b,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #%10100011001101011111101101000000+32,d4 ; width
    bfffo  d7{27:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #$1b,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{dn=rand:1},dn'
    bsr     ResetTestMemory
    move.l  #-$3,d3 ; offset
    bfffo  d7{d3:1},d2
    n0
    z1
    v0
    c0
    cmp.l   #-$2,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{dn=rand:2},dn'
    bsr     ResetTestMemory
    move.l  #-$2b2,d3 ; offset
    bfffo  d7{d3:2},d2
    n1
    z0
    v0
    c0
    cmp.l   #-$2b2,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{dn=rand:32},dn'
    bsr     ResetTestMemory
    move.l  #-$3ce,d3 ; offset
    bfffo  d7{d3:32},d2
    n1
    z0
    v0
    c0
    cmp.l   #-$3ce,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{dn=rand:dn=rand+1},dn'
    bsr     ResetTestMemory
    move.l  #-$25,d3 ; offset
    move.l  #%00001001111100000010111110000000+1,d4 ; width
    bfffo  d7{d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #-$25,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{dn=rand:dn=rand+2},dn'
    bsr     ResetTestMemory
    move.l  #-$f,d3 ; offset
    move.l  #%11100110110100000011000001000000+2,d4 ; width
    bfffo  d7{d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #-$f,d2
    z1
    EndOfTest

    StartOfTest 'bfffo  dn{dn=rand:dn=rand+32},dn'
    bsr     ResetTestMemory
    move.l  #-$33d,d3 ; offset
    move.l  #%11001110000101100110001110100000+32,d4 ; width
    bfffo  d7{d3:d4},d2
    n1
    z0
    v0
    c0
    cmp.l   #-$33d,d2
    z1
    EndOfTest

    PrintPlan
    rts

ResetTestMemory
    move.l  #%10111010110110101111101100011011,d7
    move.l  a5,a4
    move.w  #255,d0
fillLoop
    move.b  d0,-(a4)
    dbra    d0,fillLoop
    lea     -128(a5),a4
    rts
